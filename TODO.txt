
DONE
- Sleep primitive


TODO
- rename event package to es or something more generic (it has commands too)
- ensure context is passed through layers (when appropriate)
- IDs consistent with SPC format
- Run sub-pipelines
- Improve console output and logging, will make everything easier and more attractive
- Remove (unused) StackID stuff
- Passing output to input
- Stop and resume
- Log timestamps need milliseconds
- user input primitive
- Test with RedPanda instead of gochannel
- Single log file (per service or per pipeline? what about subpipelines?)



TODO
- logging using zap
- work out how to change the topic name to match our format / etc, I think it's related to the cqrs.JSONMarshaller.Name[FromMessage]
- how are events logged into a stream (in order)? can we do middleware or something for that?

NOTES
- Should we capture / load the pipeline definition at the start of the run? What happens if it changes on the way through? We should at least capture the version and then abort if changed?

DECISIONS
- Pipeline definitions and code are not stored in event history, they are referenced
- So, pipeline definitions and code can be updated and will change running pipelines
- But, a pipeline run can choose to pin its version, causing it to abort if an update is completed
- Or, upgrades can choose to pause affected pipeline runs ... queue new runs > finish existing runs > upgrade > restart new runs




timestamp
run_id
pipeline / step being executed
output

[ps_abcd1234] README.md
[ps_abcd1234] test
[ps_abcd1234] foo


[my_pipeline_1.exec_1      ] Command: ls
[my_pipeline_1.exec_1      ] README.md
[my_pipeline_1.exec_1      ] test
[my_pipeline_1.exec_1      ] foo
[my_pipeline_1.sleep_1     ] Sleeping for 5mins...

2023-02-06T11:18:25.364573 [my_pipeline_1.exec_1      ] README.md
2023-02-06T11:18:25.364573 [my_pipeline_1.exec_1      ] test
2023-02-06T11:18:25.364573 [my_pipeline_1.exec_1      ] foo
2023-02-06T11:18:25.364573 [my_pipeline_1.sleep_1     ] Sleeping for 5mins...
2023-02-06T11:18:25.364573 [my_pipeline_1.sleep_1     ] Sleeping for 5mins...